<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My remaining life</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: #000;
        color: #fff;
        min-height: 100vh;
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
      }

      h1 {
        font-size: 3rem;
        margin-bottom: 20px;
      }

      p {
        font-size: 1.2rem;
        line-height: 1.3;
      }

      .container {
        max-width: 900px;
        width: 100%;
      }

      .progress-bar {
        width: 90%;
        height: 30px;
        background-color: #333;
        border-radius: 4px;
        margin: 20px auto;
      }

      .progress-fill {
        height: 100%;
        background-color: greenyellow;
        transition: width 1s ease-in-out;
      }

      .progress-text {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        font-weight: 500;
        mix-blend-mode: difference;
        color: white;
        margin-top: 20px;
      }

      .progress-container {
        margin: 20px 0;
        width: 80%;
      }

      .progress-grid {
        display: grid;
        grid-template-columns: repeat(10, 1fr);
        gap: 6px;
        margin-bottom: 20px;
      }

      .block {
        aspect-ratio: 1/0.6;
        background-color: #333;
        border-radius: 1px;
      }

      .block.lived {
        background-color: greenyellow;
      }

      .stats {
        font-size: 1.2rem;
        margin: 20px 0;
        line-height: 1.6;
      }

      .percentage {
        font-size: 3rem;
        font-weight: 300;
        margin: 20px 0;
      }

      .grid-container {
        overflow-x: auto;
        padding: 10px 20px;
        border-radius: 4px;
        border: 1px solid #fff;
      }

      .life-container {
        display: flex;
        gap: 40px;
      }

      .regrets-container {
        margin-top: 20px;
      }

      .age-input-container {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      input[type="number"] {
        background: none;
        color: #fff;
        border: none;
        border-bottom: 1px solid #fff;
        font-size: 1.4rem;
        padding: 3px;
        margin: 0 10px;
      }

      .year-percentage {
        display: inline-block;
      }

      .regrets-grid {
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>My remaining life</h1>

      <div class="age-input-container">
        <div class="age-input-row">
          <label for="age-input">Your current age:</label>
          <input
            type="number"
            id="age-input"
            min="0"
            max="150"
            step="0"
          /><br />
          <label for="expected-age-input">Life expectancy:</label>
          <input
            type="number"
            id="expected-age-input"
            min="0"
            max="150"
            step="0"
          />
        </div>
      </div>

      <div class="life-container">
        <div class="progress-container">
          <div class="grid-container">
            <div class="progress-text" id="progressText"></div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
          </div>

          <div class="stats grid-container" id="stats"></div>

          <div class="grid-container">
            <h2>Yout life in years</h2>
            <div class="progress-grid" id="progressGrid"></div>
          </div>
        </div>

        <div class="regrets-container">
          <div class="grid-container regrets-grid">
            <h2>Top 5 regrets of the dying</h2>
            <div class="regrets" id="regrets">
              <div class="regret">
                <p>
                  I wish I had the courage to live a life true to myself, not
                  the life others expected of me.
                </p>
              </div>
              <div class="regret">
                <p>I wish I hadn't worked so hard.</p>
              </div>
              <div class="regret">
                <p>I wish I'd had the courage to express my feelings.</p>
              </div>
              <div class="regret">
                <p>I wish I had stayed in touch with my friends.</p>
              </div>
              <div class="regret">
                <p>I wish that I had let myself be happier.</p>
              </div>
            </div>
          </div>
          <div class="grid-container">
            <div>
              Current Year Progress
              <div class="year-percentage" id="year-percentage"></div>
              <div class="progress-bar">
                <div class="progress-fill" id="yearProgressFill"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initial values
      let currentAge = localStorage.getItem("currentAge") || 38;
      let expectedAge = localStorage.getItem("expectedAge") || 78;

      document.getElementById("age-input").value = currentAge;
      document.getElementById("expected-age-input").value = expectedAge;

      // Function to calculate and update everything
      function updateLifeProgress() {
        const totalWeeks = expectedAge * 52;
        const livedWeeks = currentAge * 52;
        const remainingWeeks = totalWeeks - livedWeeks;
        const remainingYears = expectedAge - currentAge;
        const remainingMonths = Math.floor((expectedAge - currentAge) * 12);
        const percentage = ((livedWeeks / totalWeeks) * 100).toFixed(1);

        // Update progress bar
        const progressFill = document.getElementById("progressFill");
        const progressText = document.getElementById("progressText");
        progressFill.style.width = `${percentage}%`;
        progressText.textContent = `You have lived ${percentage}% of your life so far`;

        // Clear and recreate grid
        const grid = document.getElementById("progressGrid");
        grid.innerHTML = "";
        for (let i = 0; i < expectedAge; i++) {
          const block = document.createElement("div");
          block.className = `block ${i < currentAge ? "lived" : ""}`;
          grid.appendChild(block);
        }

        // Update stats
        document.getElementById("stats").innerHTML = `
      Remaining Years: ${remainingYears.toLocaleString()}<br>
      Remaining Months: ${remainingMonths.toLocaleString()}<br>
      Remaining Weeks: ${remainingWeeks.toLocaleString()}
    `;
      }

      function getYearPercentage() {
        var now = new Date();
        var start = new Date(now.getFullYear(), 0, 0);
        var end = new Date(now.getFullYear() + 1, 0, 0);
        var done = (now - start) / (end - start);

        // Update the year progress bar
        const yearProgressFill = document.getElementById("yearProgressFill");
        if (yearProgressFill) {
          yearProgressFill.style.width = `${Math.floor(done * 100)}%`;
        }

        return Math.floor(done * 100) + "%";
      }

      // Initialize
      document.getElementById("year-percentage").innerHTML =
        getYearPercentage();
      updateLifeProgress();

      // Add event listeners
      document
        .getElementById("age-input")
        .addEventListener("mouseup", function (event) {
          const newAge = parseFloat(this.value);

          localStorage.setItem("currentAge", newAge);

          if (!isNaN(newAge) && newAge >= 0) {
            currentAge = newAge;
            updateLifeProgress();
          }
        });

      document
        .getElementById("expected-age-input")
        .addEventListener("mouseup", function (event) {
          const newExpectedAge = parseFloat(this.value);

          localStorage.setItem("expectedAge", newExpectedAge);

          if (!isNaN(newExpectedAge) && newExpectedAge >= 0) {
            expectedAge = newExpectedAge;
            updateLifeProgress();
          }
        });
    </script>
  </body>
</html>
